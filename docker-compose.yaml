version: '3.9'
services:


  mongodb:
    image: mongo:5.0
    ports:
      - 27017:27017
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: root
    networks:
     - user-settings-network


  rabbitmq:
    image: rabbitmq:3-management
    ports:
      - 5672:5672
      - 15672:15672
    environment:
      - RABBITMQ_DEFAULT_USER=admin
      - RABBITMQ_DEFAULT_PASS=admin

  mysql:
    image: mysql:8.0.31
    restart: always
    environment:
      MYSQL_DATABASE: 'scheduled-notifications'
      MYSQL_ROOT_PASSWORD: 'root'
    ports:
      - '3306:3306'
    expose:
      - '3306'


  user-settings-ms:
    build: user-settings-ms
    platform: linux/amd64
    environment:
      MONGODB_HOST: 'mongodb'
    ports:
      - '8080:8080'
    depends_on:
      - "mongodb"
    networks:
     - user-settings-network


networks:
  user-settings-network: